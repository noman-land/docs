<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="827" height="1022"><desc>title%20Webauthn%20Registration%0A%0Aactor%20User%0Aparticipant%20Authenticator%0A%0ABrowser-%3EServer%3A%20I%20want%20to%20register!%0ABrowser%3C%3C--Server%3A%20challenge%0Anote%20over%20Browser%3A%20credentials.create(...)%0Aactivate%20Browser%0ABrowser-%3EAuthenticator%3A%20Create%20key%20pair%0AAuthenticator-%3EUser%3A%20Request%20biometrics%20or%20device%20PIN%0AAuthenticator%3C%3C--User%3A%20Done%0AAuthenticator-%3EAuthenticator%3A%20User%20verified%0AAuthenticator-%3EAuthenticator%3A%20Cryptographic%20key%20pair%20stored%0AAuthenticator--%3E%3EBrowser%3A%20Public%20key%2C%20%5Cnchallenge%20and%20%5Cnattestation%0Adeactivate%20Browser%0ABrowser-%3EServer%3A%20Public%20key%2C%20%5Cnchallenge%20and%20%5Cnattestation%0AServer-%3EServer%3A%20Verify%20challenge%0AServer-%3EServer%3A%20Check%20attestation%0AServer-%3EServer%3A%20Store%20public%20key%0ABrowser%3C%3C--Server%3A%20Device%20regsitered!</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="827" height="1022"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="302.02231427324216" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Webauthn Registration</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.64361483359375 128.80307802049998 L 23.64361483359375 1022.3386985304999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 284.74880418372396 128.80307802049998 L 284.74880418372396 1022.3386985304999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.3459222271484 128.80307802049998 L 514.3459222271484 1022.3386985304999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 128.80307802049998 L 684.2200315866536 1022.3386985304999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 32.95468071459375 59.70516806150002 A 9.311065881 9.311065881 0 1 1 32.9546760590612 59.69585699717086 M 23.64361483359375 69.01623394250002 L 23.64361483359375 88.94518196850002 M 11.882268457593753 76.20372339450002 L 35.40496120959375 76.20372339450002 M 23.64361483359375 88.94518196850002 L 11.882268457593753 107.56731373050002 M 23.64361483359375 88.94518196850002 L 35.40496120959375 107.56731373050002" stroke-miterlimit="10" stroke-width="2.7769845610000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="8.167601650000002" y="123.90251703050001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 223.83257320283332 84.69802911050002 L 345.66503516461455 84.69802911050002 L 345.66503516461455 128.8030780205 L 223.83257320283332 128.8030780205 L 223.83257320283332 84.69802911050002 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="241.55626878333334" y="112.46787472049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authenticator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 469.7396353990898 84.69802911050002 L 558.952209055207 84.69802911050002 L 558.952209055207 128.8030780205 L 469.7396353990898 128.8030780205 L 469.7396353990898 84.69802911050002 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="487.46333097958984" y="112.46787472049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 644.9072323074231 84.69802911050002 L 723.5328308658841 84.69802911050002 L 723.5328308658841 128.8030780205 L 644.9072323074231 128.8030780205 L 644.9072323074231 84.69802911050002 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="662.6309278879231" y="112.46787472049999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Server</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 506.17832057714844 290.5215906905 L 522.5135238771485 290.5215906905 L 522.5135238771485 640.0949413105 L 506.17832057714844 640.0949413105 L 506.17832057714844 290.5215906905" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><g><rect fill="white" stroke="none" x="540.6122450569205" y="161.4734846205" width="117.34146369996094" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="543.0625255519205" y="176.17516759049997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">I want to register!</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.3459222271484 182.70924891049998 L 670.7707142029869 182.70924891049998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(684.2200315866536,182.70924891049998) translate(-684.2200315866536,-182.70924891049998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 670.6073621699869 175.90291420216664 L 684.2200315866536 182.70924891049998 L 670.6073621699869 189.51558361883332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="565.4511809089713" y="207.2120538605" width="67.66359199585938" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="567.9014614039713" y="221.91373683049997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 228.44781815049998 L 516.3878226396484 228.44781815049998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(514.3459222271484,228.44781815049998) translate(-514.3459222271484,-228.44781815049998)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 528.3411666102024 222.20442066487655 L 515.876222092698 228.44781815049998 L 528.3411666102024 234.69121563612342" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 422.62914920382815 252.95062310049997 L 591.3610122804688 252.95062310049997 L 606.0626952504688 267.65230607049995 L 606.0626952504688 290.5215906905 L 422.62914920382815 290.5215906905 L 422.62914920382815 252.95062310049997 M 591.3610122804688 252.95062310049997 L 591.3610122804688 267.65230607049995 L 606.0626952504688 267.65230607049995" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4984338238281" y="275.81990772049994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">credentials.create(...)</text></g><g><g><rect fill="white" stroke="none" x="343.31037050848306" y="315.02439564049996" width="104.30638374390625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="345.7606510034831" y="329.72607861049994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Create key pair</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 506.17832057714844 336.2601599305 L 298.1981215673906 336.2601599305" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(284.74880418372396,336.2601599305) translate(-284.74880418372396,-336.2601599305)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 298.36147360039064 329.45382522216664 L 284.74880418372396 336.2601599305 L 298.36147360039064 343.0664946388333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="42.973605405260415" y="360.76296488049996" width="222.44520820679688" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="45.423885900260416" y="375.46464785049994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request biometrics or device PIN</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 284.74880418372396 381.9987291705 L 37.09293221726042 381.9987291705" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(23.64361483359375,381.9987291705) translate(-23.64361483359375,-381.9987291705)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 37.25628425026042 375.19239446216665 L 23.64361483359375 381.9987291705 L 37.25628425026042 388.8050638788333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="134.22266698973309" y="406.50153412049997" width="39.947085037851565" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="136.67294748473307" y="421.20321709049995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Done</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 23.64361483359375 427.7372984105 L 282.70690377122395 427.7372984105" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(284.74880418372396,427.7372984105) translate(-284.74880418372396,-427.7372984105)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 270.7535598006699 421.4939009248765 L 283.2185043181745 427.7372984105 L 270.7535598006699 433.98069589612345" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><g><rect fill="white" stroke="none" x="304.0787947553906" y="452.2401033605" width="87.18397773804688" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="306.52907525039063" y="466.94178633049995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User verified</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 284.74880418372396 473.47586765049994 L 350.089617383724 473.47586765049994 L 350.089617383724 494.71163194049996 L 298.1981215673906 494.71163194049996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(284.74880418372396,494.71163194049996) translate(-284.74880418372396,-494.71163194049996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 298.36147360039064 487.9052972321666 L 284.74880418372396 494.71163194049996 L 298.36147360039064 501.5179666488333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="304.0787947553906" y="519.2144368904999" width="196.38220466675781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="306.52907525039063" y="533.9161198604999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Cryptographic key pair stored</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 284.74880418372396 540.4502011804999 L 350.089617383724 540.4502011804999 L 350.089617383724 561.6859654704999 L 298.1981215673906 561.6859654704999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(284.74880418372396,561.6859654704999) translate(-284.74880418372396,-561.6859654704999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 298.36147360039064 554.8796307621666 L 284.74880418372396 561.6859654704999 L 298.36147360039064 568.4923001788333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="345.3289786017448" y="586.1887704205" width="78.77310432496094" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="345.3289786017448" y="602.5239737205" width="100.26916755738281" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="345.3289786017448" y="618.8591770204999" width="72.54548896851563" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="347.7792590967448" y="600.8904533904999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Public key, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="347.7792590967448" y="617.2256566904999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">challenge and </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="347.7792590967448" y="633.5608599904999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">attestation</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 284.74880418372396 640.0949413105 L 504.1364201646484 640.0949413105" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(506.17832057714844,640.0949413105) translate(-506.17832057714844,-640.0949413105)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 492.1830761940944 633.8515438248766 L 504.648020711599 640.0949413105 L 492.1830761940944 646.3383387961234" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g><g><g><rect fill="white" stroke="none" x="549.1483931282096" y="664.5977462605" width="78.77310432496094" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="549.1483931282096" y="680.9329495605" width="100.26916755738281" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="549.1483931282096" y="697.2681528605" width="72.54548896851563" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.5986736232096" y="679.2994292305" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Public key, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.5986736232096" y="695.6346325305" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">challenge and </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="551.5986736232096" y="711.9698358305" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">attestation</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.3459222271484 718.5039171505 L 670.7707142029869 718.5039171505" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(684.2200315866536,718.5039171505) translate(-684.2200315866536,-718.5039171505)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 670.6073621699869 711.6975824421667 L 684.2200315866536 718.5039171505 L 670.6073621699869 725.3102518588333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="703.5500221583203" y="743.0067221004999" width="108.40085090699219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="706.0003026533203" y="757.7084050704999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 764.2424863905 L 749.5608447866535 764.2424863905 L 749.5608447866535 785.4782506805 L 697.6693489703202 785.4782506805" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(684.2200315866536,785.4782506805) translate(-684.2200315866536,-785.4782506805)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 697.8327010033203 778.6719159721666 L 684.2200315866536 785.4782506805 L 697.8327010033203 792.2845853888333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="703.5500221583203" y="809.9810556304999" width="118.17181648316406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="706.0003026533203" y="824.6827386004999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Check attestation</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 831.2168199204999 L 749.5608447866535 831.2168199204999 L 749.5608447866535 852.4525842104999 L 697.6693489703202 852.4525842104999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(684.2200315866536,852.4525842104999) translate(-684.2200315866536,-852.4525842104999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 697.8327010033203 845.6462495021666 L 684.2200315866536 852.4525842104999 L 697.8327010033203 859.2589189188333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="703.5500221583203" y="876.9553891604999" width="109.20257820191406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="706.0003026533203" y="891.6570721304998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store public key</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 898.1911534504999 L 749.5608447866535 898.1911534504999 L 749.5608447866535 919.4269177404999 L 697.6693489703202 919.4269177404999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(684.2200315866536,919.4269177404999) translate(-684.2200315866536,-919.4269177404999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 697.8327010033203 912.6205830321666 L 684.2200315866536 919.4269177404999 L 697.8327010033203 926.2332524488332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="537.7597136238151" y="943.9297226904998" width="123.04652656617188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="540.2099941188151" y="958.6314056604998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Device regsitered!</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 684.2200315866536 965.1654869804998 L 516.3878226396484 965.1654869804998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(514.3459222271484,965.1654869804998) translate(-514.3459222271484,-965.1654869804998)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 528.3411666102024 958.9220894948764 L 515.876222092698 965.1654869804998 L 528.3411666102024 971.4088844661233" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g></g><g/><g/><g/><g/></g></svg>